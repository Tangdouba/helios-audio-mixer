!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("audioMixer",[],e):"object"==typeof exports?exports.audioMixer=e():t.audioMixer=e()}(this,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.r(e);var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.id=e.id,this.events={},this.timelineEvents=e.timelineEvents?o(e.timelineEvents):[]}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){}},{key:"on",value:function(t,e){if("string"!=typeof t)throw new Error("Event name must be a string.");if(!e)throw new Error("Can’t register an event without a callback.");return this.events[t]?this.events[t].push(e):this.events[t]=[e],this}},{key:"off",value:function(t,e){if(this.events[t])if(e){var n=this.events[t].indexOf(e);this.events[t].splice(n,1)}else this.events[t]=[];return this}},{key:"one",value:function(t,e){var n=this;return n.on(t,function o(){n.off(t,o),e()}),n}},{key:"trigger",value:function(t){var e=this;if(e.events[t]){var n=Array.prototype.slice.call(arguments,1);e.events[t].forEach(function(t){return t.apply(e,n)})}return e}},{key:"updateTimelineEvents",value:function(t){for(var e,n=0;n<this.timelineEvents.length;n++)t>=(e=this.timelineEvents[n]).time&&!e.triggered&&(e.triggered=!0,e.callback&&e.callback.call(this))}}])&&r(e.prototype,n),i&&r(e,i),t}();var a={normalize:function(t){return t>1?1:t<0?0:t},timeFormat:function(t){var e=Math.floor(t/60),n=e<10?"0".concat(e):e,o=Math.floor(t-60*n),r=o<10?"0".concat(o):o;return"".concat(n,":").concat(r)},lerp:function(t,e,n){return(1-n)*t+n*e},timeoutPromise:function(t){return new Promise(function(e){setTimeout(function(){return e()},t)})}};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){function e(t){var n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=p(e).call(this,t),n=!r||"object"!==u(r)&&"function"!=typeof r?c(o):r;var i=c(n);if(i.options=Object.assign({id:"",src:"",volume:1,muted:!1,start:0,loop:!1,autoplay:!1},t),!i.options.src)throw new Error("Can’t create an Html5Track without a src parameter");i.el=document.createElement("audio"),i.el.volume=i.options.volume,i.el.muted=i.options.muted,i.el.loop=i.options.loop,i.el.autoplay=i.options.autoplay,i.el.src=i.options.src;return["loadstart","loadedmetadata","canplay","canplaythrough","play","pause","ended","timeupdate","seeking","seeked","error"].forEach(function(t){i.el.addEventListener(t,f(p(e.prototype),"trigger",c(n)).bind(i,t,!1))}),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,i),n=e,(o=[{key:"play",value:function(){return this.el.play(),this}},{key:"pause",value:function(){return this.el.pause(),this}},{key:"stop",value:function(){return this.el.pause(),this.el.currentTime=0,this}},{key:"currentTime",value:function(t){return"number"==typeof t?(this.el.currentTime=t,this):this.el.currentTime}},{key:"duration",value:function(){return this.el.duration}},{key:"formattedTime",value:function(t){var e=a.timeFormat(this.currentTime()),n=a.timeFormat(this.duration());return t?"".concat(e,"/").concat(n):e}},{key:"volume",value:function(t){return"number"==typeof t?(this.el.volume=a.normalize(t),this):this.el.volume}},{key:"tweenVolume",value:function(t,e){var n=this;return n.volumeTween&&window.cancelAnimationFrame(n.volumeTween),new Promise(function(o,r){var i=Math.round(60*e),u=Math.round(60*e),s=n.volume(),c=a.normalize(t);!function t(){u<=0?(n.volume(c),o(n)):n.volumeTween=window.requestAnimationFrame(t);u-=1;var e=1-u/i;var r=a.lerp(s,c,e);n.volume(r)}()})}},{key:"muted",value:function(t){return"boolean"==typeof t&&(this.el.muted=t),this.el.muted}},{key:"paused",value:function(){return this.el.paused}},{key:"destroy",value:function(){this.pause()}}])&&s(n.prototype,o),r&&s(n,r),e}();function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var v={GainNode:function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.ctx=e.context,this.node=this.ctx.createGainNode?this.ctx.createGainNode():this.ctx.createGain(),this.gain("number"==typeof e.gain?e.gain:1)}var e,n,o;return e=t,(n=[{key:"gain",value:function(t){return"number"==typeof t&&this.node.gain.setTargetAtTime(a.normalize(t),this.ctx.currentTime,0),this.node.gain.value}},{key:"tweenGain",value:function(t,e){"function"==typeof this.node.gain.exponentialRampToValueAtTime&&(0===(t=a.normalize(t))&&(t=1e-6),this.node.gain.exponentialRampToValueAtTime(t,this.ctx.currentTime+e))}},{key:"muted",value:function(t){}}])&&y(e.prototype,n),o&&y(e,o),t}(),PannerNode2D:function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.ctx=e.context,this.node=this.ctx.createPanner(),this.values={pan:0,panX:0,panY:0,panZ:0}}var e,n,o;return e=t,(n=[{key:"pan",value:function(t){if("string"==typeof t&&("front"===t&&(t=0),"back"===t&&(t=180),"left"===t&&(t=270),"right"===t&&(t=90)),"number"==typeof t){this.values.pan=t%360;var e=.017453292519943295*(90-t),n=this.values.panX=Math.cos(e),o=this.values.panY=Math.sin(e),r=this.values.panZ=-.5;this.node.setPosition(n,o,r)}return this.values.pan}},{key:"tweenPan",value:function(t,e){}}])&&d(e.prototype,n),o&&d(e,o),t}(),PannerNode:function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.ctx=e.context,this.node=this.ctx.createPanner()},AnalyserNode:function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.ctx=e.context,this.node=this.ctx.createAnalyser(),this.node.smoothingTimeConstant=.2,this.node.fftSize=2048,this.processor=this.ctx.createScriptProcessor(2048,1,1),this.processor.connect(this.ctx.destination),this.node.connect(this.processor),this.bufferLength=this.node.frequencyBinCount,this.analysis={raw:new Uint8Array(this.bufferLength),average:0,low:0,mid:0,high:0}}var e,n,o;return e=t,(n=[{key:"connect",value:function(t){this.node.connect(t)}},{key:"get",value:function(){var t=Math.round(this.bufferLength/3),e=0,n=0;for(this.node.getByteFrequencyData(this.analysis.raw),e=0,n=0;n<this.bufferLength;n++)e+=this.analysis.raw[n];for(this.analysis.average=e/this.bufferLength/256,e=0,n=0;n<t;n++)e+=this.analysis.raw[n];for(this.analysis.low=e/t/256,e=0,n=t;n<2*t;n++)e+=this.analysis.raw[n];for(this.analysis.mid=e/t/256,e=0,n=2*t;n<this.bufferLength;n++)e+=this.analysis.raw[n];return this.analysis.high=e/t/256,this.analysis}}])&&m(e.prototype,n),o&&m(e,o),t}()};function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(t){function e(t){var n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=w(e).call(this,t))||"object"!==b(r)&&"function"!=typeof r?k(o):r;var i=k(n);return i.options=Object.assign({src:"",context:!1,nodes:[]},t),i.data={},i.allNodes=[],i.nodeLookup={},n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(e,i),n=e,(o=[{key:"createNodes",value:function(t,e){var n=this;if(!e)throw new Error("Can’t create nodes without a valid source.");if(!e.connect)throw new Error("Can’t create nodes without a valid source.");n.allNodes=[];var o=e;t.forEach(function(t){var e={context:n.options.context};if("string"==typeof t){if(!v[t])throw new Error("Node type ".concat(t," does not exist."));var r=new v[t](e);n.allNodes.push(r),n.nodeLookup[t]=r,o.connect(r.node),o=r.node}else if("object"===b(t))if(t.type){var i=v[t.type];if(!i)throw new Error("Node type ".concat(t.type," does not exist."));var a=new i(Object.assign(e,t.options));n.allNodes.push(a),n.nodeLookup[t.type]=a,o.connect(a.node),o=a.node}else t.node&&(n.allNodes.push(t),o.connect(t.node),o=t.node)}),o.connect(n.options.context.destination)}},{key:"nodes",value:function(){return this.allNodes}},{key:"node",value:function(t){return this.nodeLookup[t]||!1}}])&&g(n.prototype,o),r&&g(n,r),e}();function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function P(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t,e,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function M(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function F(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t,e,n){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=G(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var z={Html5Track:h,BufferSourceTrack:function(t){function e(t){var n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,n=!(r=A(e).call(this,t))||"object"!==x(r)&&"function"!=typeof r?E(o):r;var i=E(n);if(i.options=Object.assign({id:"",src:"",volume:1,start:0,loop:!1,autoplay:!1,autoload:!0,context:!1,mix:!1,nodes:[]},t),i.ctx=i.options.context,i.status={ready:!1,shouldPlayOnLoad:!1,playing:!1,muted:i.options.muted||!1},i.data={gain:i.options.volume,cachedTime:0,startTime:0},!i.ctx)throw new Error("Can’t create a WebAudioTrack without Web Audio API support");if(!i.options.src)throw new Error("Can’t create a WebAudioTrack without a src parameter");return(i.options.autoload||i.options.autoplay)&&i.load(),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(e,O),n=e,(o=[{key:"play",value:function(){if(this.status.playing)return this;if(!this.status.ready)return this.options.autoload||this.status.shouldPlayOnLoad||this.load(),this.status.shouldPlayOnLoad=!0,this;this.data.source=this.ctx.createBufferSource(),this.data.source.buffer=this.data.decodedBuffer,this.data.source.loop=!!this.options.loop;var t={type:"GainNode",options:{gain:this.data.gain}};return S(A(e.prototype),"createNodes",this).call(this,[t].concat(j(this.options.nodes)),this.data.source),this.data.startTime=this.data.source.context.currentTime-this.data.cachedTime,this.startFrom=this.data.cachedTime||0,"function"==typeof this.data.source.start?this.data.source.start(0,this.startFrom):this.data.source.noteOn(this.startFrom),this.setEndTimer(),this.status.playing=!0,S(A(e.prototype),"trigger",this).call(this,"play",this),this}},{key:"load",value:function(){var t=this,n=this;return S(A(e.prototype),"trigger",this).call(this,"loadstart"),window.fetch(n.options.src).then(function(t){return t.arrayBuffer()}).then(function(t){if(n.data.audioData=t,"function"==typeof n.ctx.createGain)return new Promise(function(e,o){n.ctx.decodeAudioData(t,function(t){n.data.decodedBuffer=t,e()})});if("function"==typeof n.ctx.createGainNode){var e=n.ctx.createBuffer(t,!0);return n.data.decodedBuffer=e,Promise.resolve()}}).then(function(){n.status.ready=!0,S(A(e.prototype),"trigger",t).call(t,"loadedmetadata"),S(A(e.prototype),"trigger",t).call(t,"canplay"),S(A(e.prototype),"trigger",t).call(t,"canplaythrough"),(n.options.autoplay||n.status.shouldPlayOnLoad)&&n.play()})}},{key:"setEndTimer",value:function(){this.data.timerDuration=this.data.source.buffer.duration-this.startFrom,this.data.onendtimer&&window.clearTimeout(this.data.onendtimer),this.data.onendtimer=window.setTimeout(this.ended.bind(this),1e3*this.data.timerDuration)}},{key:"ended",value:function(){this.options.loop?(S(A(e.prototype),"trigger",this).call(this,"ended",this),S(A(e.prototype),"trigger",this).call(this,"loop",this),this.pause(0),this.play()):(this.status.playing=!1,S(A(e.prototype),"trigger",this).call(this,"ended",this))}},{key:"pause",value:function(t){return!this.status.playing&&this.status.shouldPlayOnLoad?(this.status.shouldPlayOnLoad=!1,this.options.autoplay=!1,this):(this.data.cachedTime="number"==typeof t?t:this.currentTime(),this.status.playing=!1,this.data.onendtimer&&window.clearTimeout(this.data.onendtimer),this.data.source&&("function"==typeof this.data.source.stop?this.data.source.stop(0):"function"==typeof this.data.source.noteOff&&this.data.source.noteOff(0)),S(A(e.prototype),"trigger",this).call(this,"pause",this),this)}},{key:"currentTime",value:function(t){return"number"==typeof t?(this.status.playing?this.pause(t).play():this.data.cachedTime=t,this):this.status.ready&&this.status.playing?this.data.source.context.currentTime-this.data.startTime||0:this.data.cachedTime||0}},{key:"formattedTime",value:function(t){var e=a.timeFormat(this.currentTime()),n=a.timeFormat(this.duration());return t?"".concat(e,"/").concat(n):e}},{key:"duration",value:function(){return this.status.ready&&this.data.source&&this.data.source.buffer.duration||0}},{key:"volume",value:function(t){var e=this.node("GainNode");return"number"==typeof t?(t=a.normalize(t),this.status.muted?(this.data.gainCache=t,this.data.gain=0):this.data.gain=t,this.status.playing&&e&&e.gain(this.options.mix?this.data.gain*this.options.mix.volume():this.data.gain),this):(this.status.playing&&e&&(this.data.gain=e.gain()),this.data.gain)}},{key:"tweenVolume",value:function(t,e){var n=this;return n.volumeTween&&window.cancelAnimationFrame(n.volumeTween),n.gainNode?(n.gainNode.tweenGain(t,e),a.timeoutPromise(1e3*e)):new Promise(function(o,r){var i=Math.round(60*e),u=Math.round(60*e),s=n.volume(),c=a.normalize(t);!function t(){u<=0?(n.volume(c),o(n)):n.volumeTween=window.requestAnimationFrame(t);u-=1;var e=1-u/i;var r=a.lerp(s,c,e);n.volume(r)}()})}},{key:"muted",value:function(t){return"boolean"==typeof t?(!0===t?(this.data.gainCache=this.data.gain,this.volume(0),this.status.muted=!0):(this.status.muted=!1,this.volume(this.data.gainCache)),this):this.status.muted}},{key:"paused",value:function(){return!this.status.playing}},{key:"destroy",value:function(){this.pause()}}])&&P(n.prototype,o),r&&P(n,r),e}(),ElementSourceTrack:function(t){function e(t){var n,o,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=G(e).call(this,t),n=!r||"object"!==C(r)&&"function"!=typeof r?F(o):r;var i=F(n);if(i.options=Object.assign({id:"",src:"",volume:1,start:0,loop:!1,autoplay:!1,context:!1,mix:!1,nodes:[]},t),i.ctx=i.options.context,!i.ctx)throw new Error("Can’t create an ElementSourceTrack without Web Audio API support");if(!i.options.src)throw new Error("Can’t create an ElementSourceTrack without a src parameter");i.el=document.createElement("audio"),i.el.volume=i.options.volume,i.el.muted=i.options.muted,i.el.loop=i.options.loop,i.el.autoplay=i.options.autoplay,i.el.src=i.options.src;["loadstart","loadedmetadata","canplay","canplaythrough","play","pause","ended","timeupdate","seeking","seeked","error"].forEach(function(t){i.el.addEventListener(t,R(G(e.prototype),"trigger",F(n)).bind(i,t,!1))}),i.data.source=i.ctx.createMediaElementSource(i.el);var a={type:"GainNode",options:{gain:i.data.gain}};return R(G(e.prototype),"createNodes",F(n)).call(F(n),[a].concat(N(i.options.nodes)),i.data.source),n}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(e,O),n=e,(o=[{key:"play",value:function(){return this.el.play(),this}},{key:"pause",value:function(){return this.el.pause(),this}},{key:"stop",value:function(){return this.el.pause(),this.el.currentTime=0,this}},{key:"currentTime",value:function(t){return"number"==typeof t?(this.el.currentTime=t,this):this.el.currentTime}},{key:"duration",value:function(){return this.el.duration}},{key:"formattedTime",value:function(t){var e=a.timeFormat(this.currentTime()),n=a.timeFormat(this.duration());return t?"".concat(e,"/").concat(n):e}},{key:"volume",value:function(t){var e=this.node("GainNode");return"number"==typeof t?(t=a.normalize(t),t=this.options.mix?t*this.options.mix.volume():t,e&&e.gain(t),this.el.volume=t,this):this.el.volume}},{key:"tweenVolume",value:function(t,e){var n=this;return n.volumeTween&&window.cancelAnimationFrame(n.volumeTween),new Promise(function(o,r){var i=Math.round(60*e),u=Math.round(60*e),s=n.volume(),c=a.normalize(t);!function t(){u<=0?(n.volume(c),o(n)):n.volumeTween=window.requestAnimationFrame(t);u-=1;var e=1-u/i;var r=a.lerp(s,c,e);n.volume(r)}()})}},{key:"muted",value:function(t){return"boolean"==typeof t&&(this.el.muted=t),this.el.muted}},{key:"destroy",value:function(){this.pause()}},{key:"paused",value:function(){return this.el.paused}}])&&M(n.prototype,o),r&&M(n,r),e}()};function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var V=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.allTracks=[],this.lookup={},this.currentVolume=1,(window.AudioContext||window.webkitAudioContext)&&(this.context="function"==typeof window.AudioContext?new window.AudioContext:new window.webkitAudioContext)}var e,n,o;return e=t,(n=[{key:"track",value:function(t,e){if(!t)throw new Error("Can’t create a track without a name");if(this.lookup[t])return this.lookup[t];if(e){var n={id:t,timeline:[],mix:this,context:this.context,type:z.Html5Track},o=Object.assign(n,e);"string"==typeof o.type&&z[o.type]&&(o.type=z[o.type]);var r=new o.type(o);return this.allTracks.push(r),this.lookup[t]=r,r}return!1}},{key:"tracks",value:function(){return this.allTracks}},{key:"remove",value:function(t){var e;"string"==typeof t?e=t:"object"===B(t)&&t.id&&(e=t.id);for(var n=this.lookup[e],o=this.allTracks.length-1;o>=0;o--)this.allTracks[o]===n&&this.allTracks.splice(o,1);n.destroy&&n.destroy(),n=null,delete this.lookup[e]}},{key:"volume",value:function(t){return"number"==typeof t&&(this.currentVolume=a.normalize(t),this.allTracks.forEach(function(t){return t.volume?t.volume(t.volume()):""})),this.currentVolume}}])&&D(e.prototype,n),o&&D(e,o),t}();e.default={Mixer:V,Html5Track:h}}])});
//# sourceMappingURL=audioMixer.min.js.map
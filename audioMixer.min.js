!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("audioMixer",[],e):"object"==typeof exports?exports.audioMixer=e():t.audioMixer=e()}(this,function(){return function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,o){"use strict";function n(t){return t>1?1:t<0?0:t}function r(t){var e=Math.floor(t/60)<10?"0"+Math.floor(t/60):Math.floor(t/60);return e+":"+(Math.floor(t-60*e)<10?"0"+Math.floor(t-60*e):Math.floor(t-60*e))}function a(t,e,o){return(1-o)*t+o*e}t.exports={normalize:n,timeFormat:r,lerp:a}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),c=function t(e,o,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,o);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,o,n)}if("value"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(n)},l=o(2),f=n(l),s=o(0),p=n(s),d=function(t){function e(t){r(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=o,u={id:"",src:"",volume:1,muted:!1,start:0,loop:!1,autoplay:!1};if(n.options=Object.assign(u,t),!n.options.src)throw new Error("Can’t create an Html5Track without a src parameter");return n.el=document.createElement("audio"),n.el.volume=n.options.volume,n.el.muted=n.options.muted,n.el.loop=n.options.loop,n.el.autoplay=n.options.autoplay,n.el.src=n.options.src,["loadstart","loadedmetadata","canplay","canplaythrough","play","pause","ended","timeupdate","seeking","seeked","error"].forEach(function(t){n.el.addEventListener(t,c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",o).bind(n,t,!1))}),o}return u(e,t),i(e,[{key:"play",value:function(){return this.el.play(),this}},{key:"pause",value:function(){return this.el.pause(),this}},{key:"stop",value:function(){return this.el.pause(),this.el.currentTime=0,this}},{key:"currentTime",value:function(t){var e=this;return"number"==typeof t?(e.el.currentTime=t,e):e.el.currentTime}},{key:"duration",value:function(){return track.el.duration}},{key:"formattedTime",value:function(t){var e=this;return t?p.default.timeFormat(e.currentTime())+"/"+p.default.timeFormat(e.duration()):p.default.timeFormat(e.currentTime())}},{key:"volume",value:function(t){var e=this;return"number"==typeof t?(e.el.volume=p.default.normalize(t),e):e.el.volume}},{key:"tweenVolume",value:function(t,e){var o=this;return o.volumeTween&&window.cancelAnimationFrame(o.volumeTween),new Promise(function(n,r){function a(){i<=0?(o.volume(l),n(o)):o.volumeTween=window.requestAnimationFrame(a),i-=1;var t=1-i/u,e=p.default.lerp(c,l,t);o.volume(e)}var u=Math.round(60*e),i=Math.round(60*e),c=o.volume(),l=p.default.normalize(t);a()})}},{key:"muted",value:function(t){var e=this;return"boolean"==typeof t&&(e.el.muted=t),e.el.muted}}]),e}(f.default);t.exports=d},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this.id=e.id,this.events={}}return r(t,[{key:"on",value:function(t,e){var o=this;if("string"!=typeof t)throw new Error("Event name must be a string.");if(!e)throw new Error("Can’t register an event without a callback.");return o.events[t]?o.events[t].push(e):o.events[t]=[e],o}},{key:"off",value:function(t,e){var o=this;if(e){if(o.events[t]){var n=o.events[t].indexOf(e);o.events[t].splice(n,1)}}else o.events[t]&&(o.events[t]=[]);return o}},{key:"one",value:function(t,e){var o=this,n=function n(){o.off(t,n),e()};return o.on(t,n),o}},{key:"trigger",value:function(t){var e=this;if(e.events[t]){var o=Array.prototype.slice.call(arguments,1);e.events[t].forEach(function(t){return t.apply(e,o)})}return e}},{key:"destroy",value:function(){}}]),t}();t.exports=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=o(9),a=n(r),u=o(10),i=n(u),c=o(11),l=n(c);e.default={GainNode:a.default,PannerNode2D:i.default,PannerNode:l.default}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=o(5),a=n(r),u=o(1),i=n(u);e.default={Mixer:a.default,Html5Track:i.default}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=o(6),c=n(i),l=o(0),f=n(l),s=function(){function t(){r(this,t);var e=this;e.allTracks=[],e.lookup={},e.currentVolume=1,(window.AudioContext||window.webkitAudioContext)&&(this.context="function"==typeof window.AudioContext?new window.AudioContext:new window.webkitAudioContext)}return u(t,[{key:"track",value:function(t,e){var o=this;if(!t)throw new Error("Can’t create a track without a name");if(o.lookup[t])return o.lookup[t];if(e){var n={id:t,timeline:[],mix:o,context:o.context,type:c.default.Html5Track},r=Object.assign(n,e);"string"==typeof r.type&&c.default[r.type]&&(r.type=c.default[r.type]);var a=new r.type(r);return o.allTracks.push(a),o.lookup[t]=a,a}return!1}},{key:"tracks",value:function(){return this.allTracks}},{key:"remove",value:function(t){var e=this,o=void 0;"string"==typeof t?o=t:"object"===(void 0===t?"undefined":a(t))&&t.id&&(o=t.id);for(var n=e.lookup[o],r=e.allTracks.length-1;r>=0;r--)e.allTracks[r]===n&&e.allTracks.splice(r,1);n.destroy&&n.destroy(),n=null,delete e.lookup[o]}},{key:"volume",value:function(t){var e=this;return"number"==typeof t&&(e.currentVolume=f.default.normalize(t),e.allTracks.forEach(function(t){return t.volume?t.volume(t.volume()):""})),e.currentVolume}}]),t}();t.exports=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),a=n(r),u=o(7),i=n(u);e.default={Html5Track:a.default,BufferSourceTrack:i.default}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),c=function t(e,o,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,o);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,o,n)}if("value"in r)return r.value;var u=r.get;if(void 0!==u)return u.call(n)},l=o(8),f=n(l),s=o(0),p=n(s),d=o(3),y=(n(d),function(t){function e(t){r(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=o,u={id:"",src:"",volume:1,start:0,loop:!1,autoplay:!1,autoload:!0,context:!1,mix:!1,nodes:[]};if(n.options=Object.assign(u,t),n.status={ready:!1,shouldPlayOnLoad:!1,playing:!1,muted:!1},n.data={cachedTime:0,startTime:0},!n.options.context)throw new Error("Can’t create a WebAudioTrack without Web Audio API support");if(!n.options.src)throw new Error("Can’t create a WebAudioTrack without a src parameter");return(n.options.autoload||n.options.autoplay)&&n.load(),o}return u(e,t),i(e,[{key:"play",value:function(){var t=this;if(t.status.playing)return t;if(!t.status.ready)return t.options.autoload||t.status.shouldPlayOnLoad||t.load(),t.status.shouldPlayOnLoad=!0,t;var o=t.options.context;t.data.source=o.createBufferSource(),t.data.source.buffer=t.data.decodedBuffer;var n={type:"GainNode",options:{gain:t.data.gain}},r=[n].concat(t.options.nodes||[]);c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createNodes",this).call(this,r,t.data.source),t.data.startTime=t.data.source.context.currentTime-t.data.cachedTime;var a=t.data.cachedTime||0;return"function"==typeof t.data.source.start?t.data.source.start(0,a):t.data.source.noteOn(a),t.setEndTimer(),t.status.playing=!0,c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",this).call(this,"play",t),t}},{key:"load",value:function(){var t=this,o=this,n=o.options.context;return c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",this).call(this,"loadstart"),window.fetch(o.options.src).then(function(t){if(o.data.audioData=t,"function"==typeof n.createGain)return new Promise(function(e,r){n.decodeAudioData(t,function(t){o.data.decodedBuffer=t,e()})});if("function"==typeof n.createGainNode){var e=n.createBuffer(t,!0);return o.data.decodedBuffer=e,Promise.resolve()}}).then(function(){o.status.ready=!0,c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",t).call(t,"loadedmetadata"),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",t).call(t,"canplay"),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",t).call(t,"canplaythrough"),(o.options.autoplay||o.status.shouldPlayOnLoad)&&o.play()})}},{key:"setEndTimer",value:function(){var t=this,e=t.data.cachedTime||0;t.data.timerDuration=t.data.source.buffer.duration-e,t.data.onendtimer&&window.clearTimeout(t.data.onendtimer),t.data.onendtimer=window.setTimeout(t.ended.bind(t),1e3*t.data.timerDuration)}},{key:"ended",value:function(){var t=this;t.options.loop?(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",this).call(this,"loop",t),t.pause(0),t.play()):c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",this).call(this,"ended",t)}},{key:"pause",value:function(t){var o=this;return!o.status.playing&&o.status.shouldPlayOnLoad?(o.status.shouldPlayOnLoad=!1,o.options.autoplay=!1,o):(o.data.cachedTime="number"==typeof t?t:o.currentTime(),o.status.playing=!1,o.data.onendtimer&&window.clearTimeout(o.data.onendtimer),"function"==typeof o.data.source.stop?o.data.source.stop(0):"function"==typeof o.data.source.noteOff&&o.data.source.noteOff(0),c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"trigger",this).call(this,"pause",o),o)}},{key:"currentTime",value:function(t){var e=this;return"number"==typeof t?e.status.ready?(e.status.playing?pause(t).play():e.data.cachedTime=t,e):(console.warn("Can’t set currentTime for track "+e.options.id+" before it loads. Listen for the 'canplaythrough' or 'play' events."),e):e.status.ready&&e.status.playing?e.data.source.context.currentTime-e.data.startTime||0:e.data.cachedTime||0}},{key:"formattedTime",value:function(t){var e=this;return t?p.default.timeFormat(e.currentTime())+"/"+p.default.timeFormat(e.duration()):p.default.timeFormat(e.currentTime())}},{key:"duration",value:function(){var t=this;return t.status.ready?t.data.source.buffer.duration||0:0}},{key:"volume",value:function(t){var e=this,o=e.node("GainNode");return"number"==typeof t?(t=p.default.normalize(t),e.status.muted?(e.data.gainCache=t,e.data.gain=0):e.data.gain=t,e.status.playing&&o&&o.gain(e.options.mix?e.data.gain*e.options.mix.volume():e.data.gain),e):(e.status.playing&&o&&(e.data.gain=o.gain()),e.data.gain)}},{key:"tweenVolume",value:function(t,e){var o=track.node("GainNode");if("function"==typeof o.gain.exponentialRampToValueAtTime)return new Promise(function(n,r){t=p.default.normalize(t),0===t&&(t=1e-6),o.gain.exponentialRampToValueAtTime(t,track.options.context.currentTime+e),setTimeout(function(){return n()},1e3*e)})}},{key:"muted",value:function(t){var e=this;return"boolean"==typeof t?(t?(e.data.gainCache=e.data.gain,e.volume(0),e.status.muted=!0):(e.status.muted=!1,e.volume(e.data.gainCache)),e):e.status.muted}}]),e}(f.default));t.exports=y},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),l=o(2),f=n(l),s=o(0),p=(n(s),o(3)),d=n(p),y=function(t){function e(t){r(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=o,u={src:"",context:!1,nodes:[]};return n.options=Object.assign(u,t),n.data={},n.allNodes=[],n.nodeLookup={},o}return u(e,t),c(e,[{key:"createNodes",value:function(t,e){var o=this;if(!e)throw new Error("Can’t create nodes without a valid source.");if(!e.connect)throw new Error("Can’t create nodes without a valid source.");var n={context:o.options.context},r=e;t.forEach(function(t){if("string"==typeof t){if(!d.default[t])throw new Error("Node type "+t+" does not exist.");var e=new d.default[t](n);o.allNodes.push(e),o.nodeLookup[t]=e,r.connect(e),r=e}else if("object"===(void 0===t?"undefined":i(t)))if(t.type){if(!d.default[t.type])throw new Error("Node type "+t.type+" does not exist.");t.options||(t.options={});var a=new d.default[t.type](Object.assign(n,t.options));o.allNodes.push(a),o.nodeLookup[t.type]=a,r.connect(a),r=a}else t.connect&&(o.allNodes.push(t),r.connect(t),r=t)}),r.connect(o.options.context.destination)}},{key:"nodes",value:function(){return this.allNodes}},{key:"node",value:function(t){return this.nodeLookup[t]||!1}}]),e}(f.default);t.exports=y},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(0),u=function(t){return t&&t.__esModule?t:{default:t}}(a),i=function(){function t(e){n(this,t);var o=e.context;this.node=o.createGainNode?o.createGainNode():o.createGain(),this.gainValue=1,this.gain("number"==typeof e.gain?e.gain:1)}return r(t,[{key:"connect",value:function(t){this.node.connect(t)}},{key:"gain",value:function(t){return"number"==typeof t&&(this.node.gain.value=u.default.normalize(t,0,1)),this.node.gain.value}},{key:"tweenGain",value:function(t,e,o){}},{key:"muted",value:function(t){}}]),t}();e.default=i},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t);var o=e.context;this.node=o.createPanner()}return r(t,[{key:"connect",value:function(t){this.node.connect(t)}}]),t}();e.default=a},function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t);var o=e.context;this.node=o.createPanner()}return r(t,[{key:"connect",value:function(t){this.node.connect(t)}}]),t}();e.default=a}])});
//# sourceMappingURL=audioMixer.min.js.map